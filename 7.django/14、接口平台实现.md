### 一、项目分析

#### 1.架构设计

- 结构模式
  - 前后端分离
- 前端架构
  - vue + element ui + vue router + axios
- 后端架构
  - Django + Django RestFramework + mysql + coreapi + httprunner + yaml
- 数据库选型
- 源代码管理

#### 2.测试平台结构

- 项目模块(projects)
- 接口模块(interfaces)
- 用例模块(testcases)
- 套件模块(testsuites)
- 配置模块(configures)
- 内置函数模块(debugtalks)
- 环境变量模块(envs)
- 用户模块(users)
- 测试报告模块(reports)

### 二、项目工程搭建

#### 1.搭建项目

1. 新建需要的模块

   ```python
   python manage.py start projects
   python manage.py start interfaces
   python manage.py start testcases
   ...
   ```

2. 新建apps包集中管理应用程序

   - 新建apps package，将新建的应用拖至改目录

   - 项目配置文件settings.py添加apps搜索路径

     ```python
     sys.path.insert(0, os.path.join((BASE_DIR, "apps")))
     ```

   - j将apps/目录设置为Sources Root(pycharm机制:添加后在配置添加app有智能提示)

#### 2.数据库设计

##### 1.项目模型

```python
from django.db import models
from utils.base_models import BaseModel


class Projects(BaseModel):
    name = models.CharField('项目名称', max_length=200, unique=True, help_text='项目名称')
    leader = models.CharField('负责人', max_length=50, help_text='项目负责人')
    tester = models.CharField('测试人员', max_length=50, help_text='项目测试人员')
    programmer = models.CharField('开发人员', max_length=50, help_text='开发人员')
    publish_app = models.CharField('发布应用', max_length=100, help_text='发布应用')
    des = models.CharField('简要描述', max_length=200, null=True, blank=True, default='', help_text='项目简要描述')

    class Meta:
        db_table = 'tb_projects'
        verbose_name = '项目表'
        verbose_name_plural = verbose_name

    def __str__(self):
        return self.name
```

##### 2.接口模型

```python
from django.db import models
from utils.base_models import BaseModel


class Interfaces(BaseModel):
    name = models.CharField('接口名称', max_length=200, unique=True, help_text='接口名称')
    projects = models.ForeignKey('projects.Projects', on_delete=models.CASCADE, related_name='interfaces',
                                 help_text='所属项目')
    tester = models.CharField('测试人员', max_length=50, help_text='测试人员')
    des = models.CharField('接口描述', null=True, blank=True, max_length=200, help_text='接口描述')

    class Meta:
        db_table = "tb_interfaces"
        verbose_name = "接口信息"
        verbose_name_plural = verbose_name

    def __str__(self):
        return self.name
```

##### 3.用例模型

```python
from django.db import models
from utils.base_models import BaseModel


class Testcases(BaseModel):
    name = models.CharField('用例名称', max_length=50, unique=True, help_text='用例名称')
    interfaces = models.ForeignKey('interfaces.Interfaces', on_delete=models.CASCADE, help_text='所属接口')
    include = models.TextField('前置', null=True, help_text='用例执行前置顺序')
    author = models.CharField('编写人员', max_length=50, help_text='编写人员')
    request = models.TextField('请求信息', help_text='请求信息')

    class Meta:
        db_table = 'tb_testcases'
        verbose_name = '用例信息'
        verbose_name_plural = verbose_name

    def __str__(self):
        return self.name
```

##### 4.配置模型

```python
from django.db import models
from utils.base_models import BaseModel


class Configures(BaseModel):
    name = models.CharField('配置名称', max_length=50, help_text='配置名称')
    interfaces = models.ForeignKey('interfaces.Interfaces', on_delete=models.CASCADE, related_name='configures',
                                   help_text='所属接口')
    author = models.CharField('编写人员', max_length=50, help_text='编写人员')
    request = models.TextField('请求信息', help_text='请求信息')

    class Meta:
        db_table = 'tb_configures'
        verbose_name = '配置信息'
        verbose_name_plural = verbose_name

    def __str__(self):
        return self.name
```

##### 5.套件模型

```python
from django.db import models
from utils.base_models import BaseModel


class Testsuites(BaseModel):
    name = models.CharField('套件名称', max_length=200, unique=True, help_text='套件名称')
    projects = models.ForeignKey('projects.Projects', on_delete=models.CASCADE, related_name='testsuites',
                                 help_text='所属项目')
    include = models.TextField('包含接口', null=False, help_text='包含接口')

    class Meta:
        db_table = 'tb_testsuites'
        verbose_name = '套件信息'
        verbose_name_plural = verbose_name

    def __str__(self):
        return self.name
```

##### 6.内置函数模型

```python
from django.db import models
from utils.base_models import BaseModel


class DebugTalks(BaseModel):
    name = models.CharField('debugtalk文件名称', max_length=200, default='debugtalk.py', help_text='debugtalk文件名称')
    debugtalk = models.TextField(null=True, default='#debugtalk.py', help_text='debugtalk.py文件')
    projects = models.OneToOneField('projects.Projects', on_delete=models.CASCADE, related_name='debuftalks',
                                    help_text='所属项目')

    class Meta:
        db_table = 'tb_debugtalks'
        verbose_name = 'debugtalk.py文件'
        verbose_name_plural = verbose_name

    def __str__(self):
        return self.name
```

##### 7.环境变量模型

```python
from django.db import models
from utils.base_models import BaseModel


class Envs(BaseModel):
    name = models.CharField('环境名称', max_length=200, unique=True, help_text='环境名称')
    base_url = models.URLField(verbose_name='请求base url', max_length=200, help_text='请求base url')
    desc = models.CharField(verbose_name='简要描述', max_length=200, help_text='简要描述')

    class Meta:
        db_table = 'tb_envs'
        verbose_name = '环境信息'
        verbose_name_plural = verbose_name

    def __str__(self):
        return self.name
```

##### 8.测试报告模型

```python
from django.db import models
from utils.base_models import BaseModel


class Reports(BaseModel):
    name = models.CharField('报告名称', max_length=200, unique=True, help_text='报告名称')
    result = models.BooleanField('执行结果', default=1, help_text='执行结果')
    count = models.IntegerField('用例总数', help_text='总用例数')
    success = models.IntegerField('成功总数', help_text='成功总数')
    html = models.TextField('报告Html源码', help_text='报告Html源码', null=True, blank=True, default='')
    summary = models.TextField('报告详情', help_text='报告详情', null=True, blank=True, default='')

    class Meta:
        db_table = 'tb_reports'
        verbose_name = '测试报告'
        verbose_name_plural = verbose_name

    def __str__(self):
        return self.name
```

##### 9.用户模型

- 直接使用django自带的用户模型



